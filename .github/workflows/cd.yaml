name: CD Workflow - Build and Push Docker Image 

on: 
  push: 
    branches: 
      - main 

jobs: 
  build-and-push: 
    runs-on: ubuntu-latest 
    # Indent permissions to align with the 'build-and-push' job
    permissions: 
      contents: read 
      packages: write 

    steps: 
      - name: Checkout repository 
        uses: actions/checkout@v4 

      - name: Log in to the Container registry 
        uses: docker/login-action@v3 
        with: 
          registry: ghcr.io 
          username: ${{ github.actor }} 
          password: ${{ secrets.GITHUB_TOKEN }} 

      - name: Build and push Docker image 
        uses: docker/build-push-action@v5 
        with: 
          context: . 
          push: true 
          tags: ghcr.io/${{ github.repository }}:${{ github.sha }}